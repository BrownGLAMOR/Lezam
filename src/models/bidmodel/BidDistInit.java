package models.bidmodel;

import java.io.IOException;
import java.text.ParseException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.LinkedList;

import simulator.parser.GameStatus;
import simulator.parser.GameStatusHandler;
import edu.umich.eecs.tac.props.BidBundle;
import edu.umich.eecs.tac.props.Query;
import edu.umich.eecs.tac.props.QueryReport;
import edu.umich.eecs.tac.props.QueryType;
import edu.umich.eecs.tac.props.UserClickModel;

/**
 * 
 * Builds initial bid distributions from game logs
 * for the bid prediction models
 * 
 * @author jberg
 *
 */

public final class BidDistInit {

	public static void buildBidDistribution(String filename, int min, int max) throws IOException, ParseException {
		ArrayList<Double> bidDist = new ArrayList<Double>();
		double startVal = Math.pow(2, (1.0/25.0-2.0))-0.25;
		double aStep = Math.pow(2, (1.0/25.0));
		double maxBid = 3.75;
		int count = 0;
		for(double curKey = startVal; curKey <= maxBid+0.001; curKey = (curKey+0.25)*aStep-0.25){
			bidDist.add(curKey);
			count++;
		}

		int[] bidCountsF0 = new int[bidDist.size()];
		int[] bidCountsF1 = new int[bidDist.size()];
		int[] bidCountsF2 = new int[bidDist.size()];
		int totalF0 = 0;
		int totalF1 = 0;
		int totalF2 = 0;
		int maxF0 = 0;
		int maxF1 = 0;
		int maxF2 = 0;
		for(int i = min; i < max; i++) {
			String file = filename + i + ".slg";
			GameStatusHandler gameStatusHandler = new GameStatusHandler(file);
			GameStatus gameStatus = gameStatusHandler.getGameStatus();
			String[] advertisers = gameStatus.getAdvertisers();
			HashMap<String,LinkedList<BidBundle>> allBundles = gameStatus.getBidBundles();
			HashMap<String,LinkedList<QueryReport>> allReports = gameStatus.getQueryReports();
			UserClickModel userClickModel = gameStatus.getUserClickModel();
			double squashing = gameStatus.getPubInfo().getSquashingParameter();
			for(int j = 0; j < advertisers.length; j++) {
				LinkedList<BidBundle> bundles = allBundles.get(advertisers[j]);
				LinkedList<QueryReport> reports = allReports.get(advertisers[j]);

				for(QueryReport report : reports) {
					for(Query q : report) {
						if(q.getType().equals(QueryType.FOCUS_LEVEL_ZERO)) {
							if(report.getImpressions(q) > maxF0) {
								maxF0 = report.getImpressions(q);
							}
						}
						else if(q.getType().equals(QueryType.FOCUS_LEVEL_ONE)) {
							if(report.getImpressions(q) > maxF1) {
								maxF1 = report.getImpressions(q);
							}
						}
						else {
							if(report.getImpressions(q) > maxF2) {
								maxF2 = report.getImpressions(q);
							}
						}
					}
				}

				for(BidBundle bundle : bundles) {
					for(Query q : bundle) {
						double bid = bundle.getBid(q)* Math.pow(userClickModel.getAdvertiserEffect(userClickModel.queryIndex(q), j), squashing);
						int index = Collections.binarySearch(bidDist, bid);
						int insertIdx;
						if (index < 0) {
							insertIdx = -index-1;
						}
						else {
							insertIdx = index;
						}

						if(insertIdx <= bidCountsF0.length-1) {
							if(q.getType().equals(QueryType.FOCUS_LEVEL_ZERO)) {
								bidCountsF0[insertIdx] += 1;
								totalF0++;
							}
							else if(q.getType().equals(QueryType.FOCUS_LEVEL_ONE)) {
								bidCountsF1[insertIdx] += 1;
								totalF1++;
							}
							else if(q.getType().equals(QueryType.FOCUS_LEVEL_TWO)) {
								bidCountsF2[insertIdx] += 1;
								totalF2++;
							}
							//							if(insertIdx == 0) {
							//								System.out.println(bid + " is less than" + bidDist.get(0));
							//							}
							//							else {
							//								System.out.println(bid + " is between " + bidDist.get(insertIdx-1) + "  and" + bidDist.get(insertIdx));
							//							}
						}
						else {
							System.out.println("Bid (" + bid + ") by " + advertisers[j] + " larger than maxBid, throwing it out");
						}
					}
				}
			}
		}

		double[] initDistF0 = new double[bidCountsF0.length];
		double[] initCDFF0 = new double[bidCountsF0.length];

		double[] initDistF1 = new double[bidCountsF1.length];
		double[] initCDFF1 = new double[bidCountsF1.length];

		double[] initDistF2 = new double[bidCountsF2.length];
		double[] initCDFF2 = new double[bidCountsF2.length];
		String outputF0 = "final static double[] initDistF0 = {";
		String outputF1 = "final static double[] initDistF1 = {";
		String outputF2 = "final static double[] initDistF2 = {";
		for(int i = 0; i < bidCountsF0.length; i++) {
			initDistF0[i] = bidCountsF0[i] / ((double) totalF0);
			initDistF1[i] = bidCountsF1[i] / ((double) totalF1);
			initDistF2[i] = bidCountsF2[i] / ((double) totalF2);
			if(i == 0) {
				initCDFF0[i] = initDistF0[i];
				initCDFF1[i] = initDistF1[i];
				initCDFF2[i] = initDistF2[i];
			}
			else {
				initCDFF0[i] = initDistF0[i] + initCDFF0[i-1];
				initCDFF1[i] = initDistF1[i] + initCDFF1[i-1];
				initCDFF2[i] = initDistF2[i] + initCDFF2[i-1];
			}
			outputF0 += initDistF0[i] + ", ";
			outputF1 += initDistF1[i] + ", ";
			outputF2 += initDistF2[i] + ", ";
			System.out.println(bidDist.get(i) + ", " + initDistF0[i] + ", " + initCDFF0[i] + ", " + initDistF1[i] + ", " + initCDFF1[i] + ", " + initDistF2[i] + ", " + initCDFF2[i]);
			if((i + 1) % 5 == 0) {
				outputF0 += "\n";
				outputF1 += "\n";
				outputF2 += "\n";
			}
		}

		outputF0 = outputF0.substring(0, outputF0.length()-3);
		outputF0 += "};";
		System.out.println("\n\n\n" + outputF0 + "\n");

		outputF1 = outputF1.substring(0, outputF1.length()-3);
		outputF1 += "};";
		System.out.println(outputF1 + "\n");

		outputF2 = outputF2.substring(0, outputF2.length()-3);
		outputF2 += "};";
		System.out.println(outputF2);
		System.out.println("\n\n\n" + maxF0 + ", " +  maxF1 + ", " +  maxF2);
	}


	/**
	 * @param args
	 * @throws ParseException 
	 * @throws IOException 
	 */
	public static void main(String[] args) throws IOException, ParseException {
		//		String baseFile = "/Users/jordanberg/Desktop/finalsgames/server1/game"; //jberg HOME FILES
		//		String baseFile = "/pro/aa/finals/day-2/server-1/game"; //CS DEPT Files
		//games 1425-1464
		//		int min = 1425;
		//		int max = 1465;

		//		String baseFile = "/Users/jordanberg/Desktop/goodqual/game";
		//		int min = 1;
		//		int max = 77;

		String baseFile = "/Users/jordanberg/Desktop/goodqual/game";
		//		String baseFile = "/Users/jordanberg/Desktop/2010semifinals/reallygoodgames/game";
		int min = 1;
		int max = 25;

		buildBidDistribution(baseFile,min,max);
	}

}




/*

0.007028456664016636, 0.023871181938911024, 0.023871181938911024, 0.014780207654920366, 0.014780207654920366, 0.01165341376473814, 0.01165341376473814
0.014254510140345122, 0.01195219123505976, 0.03582337317397079, 0.0065235293801032355, 0.021303737035023602, 0.0031392152313457497, 0.014792628996083891
0.021683715631514555, 0.006341301460823373, 0.04216467463479416, 0.006388968130513647, 0.02769270516553725, 0.004506689727419094, 0.019299318723502986
0.029321784518055005, 0.004216467463479416, 0.04638114209827358, 0.004946471534913262, 0.03263917670045051, 0.004285222135510043, 0.02358454085901303
0.037174588749258775, 0.0022576361221779548, 0.04863877822045153, 0.004042219937671229, 0.03668139663812174, 0.003916109482328292, 0.02750065034134132
0.04524816535738263, 0.0017928286852589642, 0.0504316069057105, 0.0031756454903142813, 0.03985704212843602, 0.0028966554878263133, 0.030397305829167633
0.05354872109876174, 0.0018260292164674634, 0.05225763612217796, 0.02891452131181071, 0.06877156344024674, 0.055152461102557074, 0.08554976693172471
0.062082637225403026, 0.0013280212483399733, 0.05358565737051793, 0.0017977382945168982, 0.07056930173476364, 0.00226389093951474, 0.08781365787123944
0.07085647439072612, 0.0010956175298804782, 0.05468127490039841, 0.0014371141456168018, 0.07200641588038044, 0.0017119796390429789, 0.08952563751028242
0.07987697769322366, 0.0011620185922974768, 0.055843293492695886, 0.0011787565464047925, 0.07318517242678524, 0.0016697953358222072, 0.09119543284610462
0.08915108186191806, 0.0013280212483399733, 0.05717131474103586, 0.0012594932961585454, 0.07444466572294378, 0.00131474411704738, 0.092510176963152
0.09868591658760145, 0.08263612217795485, 0.13980743691899072, 9.742234470286185E-4, 0.0754188891699724, 0.0012795905310300703, 0.09378976749418207
0.10848881200395694, 0.001195219123505976, 0.1410026560424967, 7.804552476196114E-4, 0.076199344417592, 0.0010827304493331365, 0.0948724979435152
0.1185673043227754, 0.0015604249667994687, 0.14256308100929618, 7.373956477509432E-4, 0.07693674006534294, 8.999318020431264E-4, 0.09577242974555833
0.1289291416275996, 0.0029216467463479417, 0.14548472775564414, 7.535429977016939E-4, 0.07769028306304464, 0.0010229693531037102, 0.09679539909866204
0.13958228983025, 0.002556440903054449, 0.1480411686586986, 7.104833978330257E-4, 0.07840076646087767, 8.507167816188929E-4, 0.09764611588028094
0.1505349387948111, 0.002357237715803453, 0.15039840637450205, 8.934866972748655E-4, 0.07929425315815253, 6.60887417125421E-4, 0.09830700329740635
0.16179550863378667, 0.0027556440903054448, 0.15315405046480748, 8.181323975046962E-4, 0.08011238555565722, 7.382253063635022E-4, 0.09904522860376985
0.17337265618126368, 0.0022576361221779548, 0.15541168658698543, 0.02720828466701473, 0.10732067022267196, 6.327645483115733E-4, 0.09967799315208142
0.18527528164806217, 0.0024236387782204517, 0.15783532536520586, 7.266307477837762E-4, 0.10804730097045573, 5.940956036925327E-4, 0.10027208875577395
0.19751253546398634, 0.0036520584329349268, 0.1614873837981408, 7.266307477837762E-4, 0.1087739317182395, 7.311945891600402E-4, 0.101003283344934
0.2100938253124377, 0.005312084993359893, 0.16679946879150068, 0.007616166726770691, 0.11639009844501019, 0.009277031349968011, 0.11028031469490202
0.2230288233627981, 0.005079681274900398, 0.1718791500664011, 0.00138867209576455, 0.11777877054077475, 6.292491897098423E-4, 0.11090956388461186
0.23632747370614293, 0.005776892430278884, 0.17765604249667996, 0.001673941944894477, 0.11945271248566923, 6.362799069133042E-4, 0.11154584379152516
0.2500000000000002, 0.10766932270916335, 0.2853253652058433, 0.014887856654592036, 0.13434056914026127, 5.273037902596444E-4, 0.1120731475817848
0.2640569133280335, 0.013147410358565738, 0.29847277556440904, 0.0013725247458137996, 0.13571309388607505, 5.765188106838778E-4, 0.11264966639246868
0.27850902028069047, 0.00597609561752988, 0.3044488711819389, 0.0013187002459779642, 0.13703179413205302, 7.663481751773499E-4, 0.11341601456764602
0.29336743126302933, 0.010391766268260293, 0.3148406374501992, 0.0017170015447631453, 0.13874879567681617, 7.241638719565783E-4, 0.1141401784396026
0.30864356903611034, 0.02453519256308101, 0.3393758300132802, 0.014871709304641286, 0.15362050498145746, 0.009948464842898625, 0.12408864328250123
0.3243491774985179, 0.011022576361221779, 0.350398406374502, 0.0019645942440079875, 0.15558509922546546, 9.843004084846695E-4, 0.1250729436909859
0.3404963307147656, 0.04120185922974767, 0.39160026560424965, 0.001733148894713896, 0.15731824812017936, 0.001051092221917558, 0.12612403591290347
0.3570974421975238, 0.014209827357237716, 0.40581009296148735, 0.0021960395933020792, 0.15951428771348145, 0.001019453994501979, 0.12714348990740545
0.3741652744508064, 0.08662018592297477, 0.4924302788844621, 0.0022068044932692463, 0.16172109220675068, 0.0010721843735279435, 0.1282156742809334
0.3917129487814526, 0.04243027888446215, 0.5348605577689243, 0.0020345660937945735, 0.16375565830054525, 0.0012514676622162226, 0.12946714194314962
0.40975395538644765, 0.010590969455511289, 0.5454515272244356, 0.016368030400077508, 0.18012368870062276, 0.01022617817243537, 0.139693320115585
0.42830216372383645, 0.013745019920318725, 0.5591965471447543, 0.0029980246408560247, 0.18312171334147878, 0.0013534130616664206, 0.14104673317725142
0.44737183317520324, 0.11039176626826029, 0.6695883134130146, 0.004101426887490648, 0.18722314022896944, 0.0013534130616664206, 0.14240014623891784
0.4669776240079142, 0.009594953519256308, 0.6791832669322709, 0.004122956687424982, 0.19134609691639443, 0.002450204945406481, 0.14485035118432432
0.48713460864555114, 0.011819389110225764, 0.6910026560424967, 0.004015307687753312, 0.19536140460414775, 0.001690887487432593, 0.14654123867175692
0.5078582832551997, 0.1353917662682603, 0.826394422310757, 0.019328377891048448, 0.21468978249519619, 0.01055310652239635, 0.15709434519415327
0.5291645796605006, 0.0064077025232403715, 0.8328021248339974, 0.005996049281712049, 0.22068583177690823, 0.0017998636040862529, 0.15889420879823954
0.5510698775896228, 0.005378486055776893, 0.8381806108897742, 0.006060638681515052, 0.22674647045842328, 0.0031356998727440186, 0.16202990867098355
0.5735910172675739, 0.008200531208499336, 0.8463811420982735, 0.007734580626409529, 0.2344810510848328, 0.0024959046072289834, 0.16452581327821253
0.5967453123625279, 0.005776892430278884, 0.8521580345285524, 0.011561502564737418, 0.24604255364957023, 0.0033360753130426833, 0.16786188859125523
0.6205505632961249, 0.007536520584329349, 0.8596945551128817, 0.032569204850663926, 0.2786117585002342, 0.019995359726645717, 0.18785724831790093
0.6450250709279732, 0.00650730411686587, 0.8662018592297476, 0.013100883260042306, 0.2917126417602765, 0.0034450514296963434, 0.19130229974759727
0.670187650624876, 0.005444887118193891, 0.8716467463479415, 0.059551426618368146, 0.35126406837864466, 0.004355529307544663, 0.19565782905514192
0.6960576467255969, 0.0100265604249668, 0.8816733067729082, 0.05724235557541082, 0.40850642395405545, 0.003951263068345602, 0.1996090921234875
0.7226549474122865, 0.005677290836653386, 0.8873505976095616, 0.03716043468666067, 0.44566685864071615, 0.020283619131987653, 0.21989271125547516
0.7500000000000011, 0.005079681274900398, 0.892430278884462, 0.01591590460145649, 0.4615827632421726, 0.00971293581658265, 0.2296056470720578
0.7781138266560677, 0.00846613545816733, 0.9008964143426293, 0.016927805198370192, 0.4785105684405428, 0.010728874452482898, 0.2403345215245407
0.8070180405613816, 0.0032868525896414345, 0.9041832669322708, 0.06727524234481051, 0.5457858107853533, 0.019812561079355705, 0.2601470826038964
0.8367348625260593, 0.006341301460823373, 0.9105245683930941, 0.013902868307596251, 0.5596886790929495, 0.014637953217607727, 0.27478503582150415
0.8672871380722214, 0.0060756972111553785, 0.9166002656042496, 0.02200345553288946, 0.581692134625839, 0.021306588485091364, 0.2960916243065955
0.8986983549970364, 0.004116865869853918, 0.9207171314741035, 0.014171990806775428, 0.5958641254326145, 0.012356485485084334, 0.30844810979167986
0.9309926614295319, 0.004946879150066401, 0.9256640106241699, 0.04083664802544822, 0.6367007734580626, 0.088080825124971, 0.39652893491665087
0.9641948843950483, 0.002456839309428951, 0.9281208499335989, 0.015033182804148792, 0.6517339562622114, 0.04157263082407037, 0.43810156574072123
0.9983305489016134, 0.005112881806108898, 0.9332337317397078, 0.020060391088815806, 0.6717943473510273, 0.016789352681867077, 0.45489091842258833
1.0334258975629058, 0.003917662682602922, 0.9371513944223108, 0.06726985989482692, 0.7390642072458542, 0.09511857304563638, 0.5500094914682248
1.069507910772896, 0.006872509960159362, 0.9440239043824701, 0.03300518329933419, 0.7720693905451884, 0.01795645173764176, 0.5679659432058665
1.1066043274476738, 0.004548472775564409, 0.9485723771580344, 0.013348475959287148, 0.7854178665044755, 0.028463858598215604, 0.5964298018040821
1.1447436663504074, 0.0026892430278884463, 0.9512616201859229, 0.012853290560797464, 0.798271157065273, 0.016195257078174544, 0.6126250588822567
1.1839552480158295, 0.0035192563081009294, 0.9547808764940238, 0.00985526591994144, 0.8081264229852144, 0.017074096728607286, 0.629699155610864
1.2242692172911034, 0.004946879150066401, 0.9597277556440902, 0.009559231170844345, 0.8176856541560588, 0.034232562063656116, 0.6639317176745201
1.2657165665104004, 0.004913678618857902, 0.9646414342629481, 0.008924102072781489, 0.8266097562288403, 0.03503054846624904, 0.6989622661407692
1.3083291593210022, 0.004681274900398406, 0.9693227091633465, 0.00910710537222333, 0.8357168616010636, 0.01653976222114418, 0.7155020283619133
1.352139755179247, 0.003386454183266932, 0.9727091633466134, 0.009209371921911416, 0.844926233522975, 0.0190286361111697, 0.734530664473083
1.397182034535149, 0.0021580345285524567, 0.9748671978751658, 0.008170559075079796, 0.8530967925980548, 0.014465700646122912, 0.748996365119206
1.4434906247250574, 0.0018260292164674634, 0.9766932270916333, 0.006878771079019748, 0.8599755636770746, 0.014079011199932505, 0.7630753763191385
1.4911011265922516, 0.0026228419654714475, 0.9793160690571048, 0.015614487402375813, 0.8755900510794504, 0.01303494969521841, 0.7761103260143569
1.5400501418559482, 0.0030876494023904383, 0.9824037184594953, 0.007347044227591515, 0.8829370953070419, 0.012367031560889526, 0.7884773575752464
1.5903753012497537, 0.0011288180610889774, 0.9835325365205843, 0.004747320885520672, 0.8876844161925626, 0.010781604831508862, 0.7992589624067552
1.6421152934511956, 0.0031208499335989375, 0.9866533864541832, 0.004634289435865417, 0.892318705628428, 0.010472253274556538, 0.8097312156813118
1.6953098948245748, 0.0013944223107569722, 0.9880478087649401, 0.004731173535569921, 0.8970498791639979, 0.01705651993559863, 0.8267877356169104
1.750000000000004, 0.0018260292164674634, 0.9898738379814076, 0.005199446684141688, 0.9022493258481397, 0.010219147455231909, 0.8370068830721423
1.806227653312137, 7.968127490039841E-4, 0.9906706507304116, 0.0050917976844700175, 0.9073411235326097, 0.011973311397495658, 0.848980194469638
1.864036081122765, 8.300132802124834E-4, 0.9915006640106241, 0.006232877080989725, 0.9135740006135994, 0.009734027968193035, 0.858714222437831
1.9234697250521204, 4.316069057104914E-4, 0.9919322709163346, 0.004688113935701252, 0.9182621145493006, 0.009625051851539376, 0.8683392742893704
1.9845742761444445, 7.968127490039841E-4, 0.9927290836653386, 0.004359784486702658, 0.9226218990360033, 0.009002833379032996, 0.8773421076684034
2.0473967099940746, 0.007270916334661355, 1.0, 0.028629251462680784, 0.9512511504986841, 0.03562464406994158, 0.912966751738345
2.1119853228590655, 0.0, 1.0, 0.0020453309937617406, 0.9532964814924458, 0.006468259827184971, 0.91943501156553
2.178389768790099, 0.0, 1.0, 0.0011303144965525407, 0.9544267959889984, 0.004854710228990459, 0.9242897217945204
2.246661097803229, 0.0, 1.0, 0.0017708260445989806, 0.9561976220335974, 0.006921741086808265, 0.9312114628813287
2.316851795125814, 0.0, 1.0, 0.0016577945949437264, 0.9578554166285411, 0.006890102859392687, 0.9381015657407215
2.389015821545794, 0.0, 1.0, 0.0012218161462734607, 0.9590772327748146, 0.004654334788691795, 0.9427559005294133
2.46320865489535, 0.0, 1.0, 0.0017923558445333146, 0.9608695886193479, 0.007118601168505199, 0.9498745016979184
2.539487332700817, 0.0, 1.0, 0.0028419335913321027, 0.96371152221068, 0.009220785612340314, 0.9590952873102587
2.6179104960316613, 0.0, 1.0, 0.002734284591660432, 0.9664458068023405, 0.004766826263947185, 0.9638621135742059
2.698538434582209, 0.0, 1.0, 0.001334847595928715, 0.9677806543982692, 0.0035259046775361555, 0.967388018251742
2.781433133020803, 0.0, 1.0, 0.0016093525450914747, 0.9693900069433606, 0.005100785331111627, 0.9724888035828536
2.8666583186420067, 0.0, 1.0, 0.0011410793965197078, 0.9705310863398804, 0.0030196930388868967, 0.9755084966217406
2.954279510358496, 0.0, 1.0, 8.019850475539457E-4, 0.9713330713874343, 0.0027911947297743845, 0.978299691351515
3.0443640690703004, 0.0, 1.0, 0.024818476874303646, 0.9961515482617379, 0.010416007536928841, 0.9887156988884438
3.136981249450117, 0.0, 1.0, 5.382449983583528E-4, 0.9966897932600962, 0.0020318772718004962, 0.9907475761602443
3.2322022531845054, 0.0, 1.0, 5.759221482434375E-4, 0.9972657154083396, 0.0019229011551468364, 0.9926704773153912
3.3301002837118987, 0.0, 1.0, 4.7365559855535043E-4, 0.997739371006895, 0.002358805621761476, 0.9950292829371526
3.4307506024995096, 0.0, 1.0, 5.759221482434375E-4, 0.9983152931551385, 0.00131474411704738, 0.9963440270542
3.5342305869023933, 0.0, 1.0, 5.490098983255198E-4, 0.998864303053464, 0.0011917065659867963, 0.9975357336201868
3.6406197896491523, 0.0, 1.0, 5.113327484404351E-4, 0.9993756358019044, 0.0012092833589954512, 0.9987450169791823
3.7500000000000107, 0.0, 1.0, 6.243641980956892E-4, 1.0, 0.0012549830208179536, 1.0000000000000002



final static double[] initDistF0 = {0.023871181938911024, 0.01195219123505976, 0.006341301460823373, 0.004216467463479416, 0.0022576361221779548, 
0.0017928286852589642, 0.0018260292164674634, 0.0013280212483399733, 0.0010956175298804782, 0.0011620185922974768, 
0.0013280212483399733, 0.08263612217795485, 0.001195219123505976, 0.0015604249667994687, 0.0029216467463479417, 
0.002556440903054449, 0.002357237715803453, 0.0027556440903054448, 0.0022576361221779548, 0.0024236387782204517, 
0.0036520584329349268, 0.005312084993359893, 0.005079681274900398, 0.005776892430278884, 0.10766932270916335, 
0.013147410358565738, 0.00597609561752988, 0.010391766268260293, 0.02453519256308101, 0.011022576361221779, 
0.04120185922974767, 0.014209827357237716, 0.08662018592297477, 0.04243027888446215, 0.010590969455511289, 
0.013745019920318725, 0.11039176626826029, 0.009594953519256308, 0.011819389110225764, 0.1353917662682603, 
0.0064077025232403715, 0.005378486055776893, 0.008200531208499336, 0.005776892430278884, 0.007536520584329349, 
0.00650730411686587, 0.005444887118193891, 0.0100265604249668, 0.005677290836653386, 0.005079681274900398, 
0.00846613545816733, 0.0032868525896414345, 0.006341301460823373, 0.0060756972111553785, 0.004116865869853918, 
0.004946879150066401, 0.002456839309428951, 0.005112881806108898, 0.003917662682602922, 0.006872509960159362, 
0.004548472775564409, 0.0026892430278884463, 0.0035192563081009294, 0.004946879150066401, 0.004913678618857902, 
0.004681274900398406, 0.003386454183266932, 0.0021580345285524567, 0.0018260292164674634, 0.0026228419654714475, 
0.0030876494023904383, 0.0011288180610889774, 0.0031208499335989375, 0.0013944223107569722, 0.0018260292164674634, 
7.968127490039841E-4, 8.300132802124834E-4, 4.316069057104914E-4, 7.968127490039841E-4, 0.007270916334661355, 
0.0, 0.0, 0.0, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0};

final static double[] initDistF1 = {0.014780207654920366, 0.0065235293801032355, 0.006388968130513647, 0.004946471534913262, 0.004042219937671229, 
0.0031756454903142813, 0.02891452131181071, 0.0017977382945168982, 0.0014371141456168018, 0.0011787565464047925, 
0.0012594932961585454, 9.742234470286185E-4, 7.804552476196114E-4, 7.373956477509432E-4, 7.535429977016939E-4, 
7.104833978330257E-4, 8.934866972748655E-4, 8.181323975046962E-4, 0.02720828466701473, 7.266307477837762E-4, 
7.266307477837762E-4, 0.007616166726770691, 0.00138867209576455, 0.001673941944894477, 0.014887856654592036, 
0.0013725247458137996, 0.0013187002459779642, 0.0017170015447631453, 0.014871709304641286, 0.0019645942440079875, 
0.001733148894713896, 0.0021960395933020792, 0.0022068044932692463, 0.0020345660937945735, 0.016368030400077508, 
0.0029980246408560247, 0.004101426887490648, 0.004122956687424982, 0.004015307687753312, 0.019328377891048448, 
0.005996049281712049, 0.006060638681515052, 0.007734580626409529, 0.011561502564737418, 0.032569204850663926, 
0.013100883260042306, 0.059551426618368146, 0.05724235557541082, 0.03716043468666067, 0.01591590460145649, 
0.016927805198370192, 0.06727524234481051, 0.013902868307596251, 0.02200345553288946, 0.014171990806775428, 
0.04083664802544822, 0.015033182804148792, 0.020060391088815806, 0.06726985989482692, 0.03300518329933419, 
0.013348475959287148, 0.012853290560797464, 0.00985526591994144, 0.009559231170844345, 0.008924102072781489, 
0.00910710537222333, 0.009209371921911416, 0.008170559075079796, 0.006878771079019748, 0.015614487402375813, 
0.007347044227591515, 0.004747320885520672, 0.004634289435865417, 0.004731173535569921, 0.005199446684141688, 
0.0050917976844700175, 0.006232877080989725, 0.004688113935701252, 0.004359784486702658, 0.028629251462680784, 
0.0020453309937617406, 0.0011303144965525407, 0.0017708260445989806, 0.0016577945949437264, 0.0012218161462734607, 
0.0017923558445333146, 0.0028419335913321027, 0.002734284591660432, 0.001334847595928715, 0.0016093525450914747, 
0.0011410793965197078, 8.019850475539457E-4, 0.024818476874303646, 5.382449983583528E-4, 5.759221482434375E-4, 
4.7365559855535043E-4, 5.759221482434375E-4, 5.490098983255198E-4, 5.113327484404351E-4, 6.243641980956892E-4};

final static double[] initDistF2 = {0.01165341376473814, 0.0031392152313457497, 0.004506689727419094, 0.004285222135510043, 0.003916109482328292, 
0.0028966554878263133, 0.055152461102557074, 0.00226389093951474, 0.0017119796390429789, 0.0016697953358222072, 
0.00131474411704738, 0.0012795905310300703, 0.0010827304493331365, 8.999318020431264E-4, 0.0010229693531037102, 
8.507167816188929E-4, 6.60887417125421E-4, 7.382253063635022E-4, 6.327645483115733E-4, 5.940956036925327E-4, 
7.311945891600402E-4, 0.009277031349968011, 6.292491897098423E-4, 6.362799069133042E-4, 5.273037902596444E-4, 
5.765188106838778E-4, 7.663481751773499E-4, 7.241638719565783E-4, 0.009948464842898625, 9.843004084846695E-4, 
0.001051092221917558, 0.001019453994501979, 0.0010721843735279435, 0.0012514676622162226, 0.01022617817243537, 
0.0013534130616664206, 0.0013534130616664206, 0.002450204945406481, 0.001690887487432593, 0.01055310652239635, 
0.0017998636040862529, 0.0031356998727440186, 0.0024959046072289834, 0.0033360753130426833, 0.019995359726645717, 
0.0034450514296963434, 0.004355529307544663, 0.003951263068345602, 0.020283619131987653, 0.00971293581658265, 
0.010728874452482898, 0.019812561079355705, 0.014637953217607727, 0.021306588485091364, 0.012356485485084334, 
0.088080825124971, 0.04157263082407037, 0.016789352681867077, 0.09511857304563638, 0.01795645173764176, 
0.028463858598215604, 0.016195257078174544, 0.017074096728607286, 0.034232562063656116, 0.03503054846624904, 
0.01653976222114418, 0.0190286361111697, 0.014465700646122912, 0.014079011199932505, 0.01303494969521841, 
0.012367031560889526, 0.010781604831508862, 0.010472253274556538, 0.01705651993559863, 0.010219147455231909, 
0.011973311397495658, 0.009734027968193035, 0.009625051851539376, 0.009002833379032996, 0.03562464406994158, 
0.006468259827184971, 0.004854710228990459, 0.006921741086808265, 0.006890102859392687, 0.004654334788691795, 
0.007118601168505199, 0.009220785612340314, 0.004766826263947185, 0.0035259046775361555, 0.005100785331111627, 
0.0030196930388868967, 0.0027911947297743845, 0.010416007536928841, 0.0020318772718004962, 0.0019229011551468364, 
0.002358805621761476, 0.00131474411704738, 0.0011917065659867963, 0.0012092833589954512, 0.0012549830208179536};



10753, 2325, 2221

 */